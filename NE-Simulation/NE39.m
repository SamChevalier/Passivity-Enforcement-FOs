% New England Test System - Passivity Analysis
global RSc DSc

% Load at source bus set to 0

% Bus Num, V Base, V Guess, Phase Guess, Area, Region
Bus.con = [ ...
   1   1.00  1.048   -0.1646   1 1; 
   2   1.00  1.0505  -0.1203   1 1; 
   3   1.00  1.0341  -0.1698   1 1; 
   4   1.00  1.0116  -0.1838   1 1; 
   5   1.00  1.0165  -0.1637   1 1; 
   6   1.00  1.0172  -0.1515   1 1; 
   7   1.00  1.0067  -0.1892   1 1; 
   8   1.00  1.0057  -0.1979   1 1; 
   9   1.00  1.0322  -0.1946   1 1; 
  10   1.00  1.0235  -0.1101   1 1; 
  11   1.00  1.0201  -0.1243   1 1; 
  12   1.00  1.0072  -0.1246   2 1; 
  13   1.00  1.0207  -0.1225   3 1; 
  14   1.00  1.0181  -0.1511   4 1; 
  15   1.00  1.0194  -0.1581   5 1; 
  16   1.00  1.0346  -0.1337   6 1; 
  17   1.00  1.0365  -0.1510   7 1; 
  18   1.00  1.0343  -0.1656   8 1; 
  19   1.00  1.0509  -0.0531   9 1; 
  20   1.00  0.9914  -0.0777   1 1; 
  21   1.00  1.0337  -0.0918   1 1; 
  22   1.00  1.0509  -0.0143   2 1; 
  23   1.00  1.0459  -0.0178   3 1; 
  24   1.00  1.0399  -0.1316   4 1; 
  25   1.00  1.0587  -0.0962   5 1; 
  26   1.00  1.0536  -0.1182   6 1; 
  27   1.00  1.0399  -0.1532   7 1; 
  28   1.00  1.0509  -0.0571   8 1; 
  29   1.00  1.0505  -0.0089   9 1; 
  30   1.00  1.0475  -0.0780   1 1; 
  31   1.00  0.9820        0   1 1; 
  32   1.00  0.9831   0.0284   2 1; 
  33   1.00  0.9972   0.0380   3 1; 
  34   1.00  1.0123   0.0129   4 1; 
  35   1.00  1.0493   0.0723   5 1; 
  36   1.00  1.0635   0.1192   6 1; 
  37   1.00  1.0278   0.0220   7 1; 
  38   1.00  1.0265   0.1143   8 1; 
  39   1.00  1.0300  -0.1913   9 1];
       
% Bus Num, P Rating, V Rating, V Mag, Ref Angle, Max Q, Min Q, Max V, 
% Min V, P Guess, Loss Coeff
SW.con = [ ...
  31 100.0   1.00  0.98200  0  8.00000  -5.0000 1.1 0.9  2 1];   
       
% Bus Num, P Rating, V Rating, P, V, Max Q, Min Q, Max V, Min V, Loss  
PV.con = [ ...
  30 100.0   1.00  2.5000   1.0475  8       -5      1.1 0.9 1;
  32 100.0   1.00  6.5000   0.9841  8       -5      1.1 0.9 1;
  33 100.0   1.00  6.3200   0.9972  8       -5      1.1 0.9 1;
  34 100.0   1.00  5.0800   1.0123  4       -3      1.1 0.9 1;
  35 100.0   1.00  6.5000   1.0494  8       -5      1.1 0.9 1;
  36 100.0   1.00  5.6000   1.0635  8       -5      1.1 0.9 1;
  37 100.0   1.00  5.4000   1.0275  8       -5      1.1 0.9 1;
  38 100.0   1.00  8.3000   1.0265  8       -5      1.1 0.9 1;
  39 100.0   1.00  10.000   1.0300  15     -10      1.1 0.9 1]; 
  
% Bus Num, Pow Rating, V Rating, P, Q, Max V, Min V, Conv. to Imp.
PQ.con = [ ...
   1 100.0   1.00  0.9760   0.4420  1.1 0.9 0;
   2 100.0   1.00  0.0000   0.0000  1.1 0.9 0;
   3 100.0   1.00  3.2200   0.0240  1.1 0.9 0;
   4 100.0   1.00  5.0000   1.8400  1.1 0.9 0;
   5 100.0   1.00  0.0000   0.0000  1.1 0.9 0;
   6 100.0   1.00  0.0000   0.0000  1.1 0.9 0;
   7 100.0   1.00  2.3380   0.8400  1.1 0.9 0;
   8 100.0   1.00  5.2200   1.7660  1.1 0.9 0;
   9 100.0   1.00  0.0650   -0.666  1.1 0.9 0;
  10 100.0   1.00  0.0000   0.0000  1.1 0.9 0;
  11 100.0   1.00  0.0000   0.0000  1.1 0.9 0;
  12 100.0   1.00  0.0853   0.8800  1.1 0.9 0;
  13 100.0   1.00  0.0000   0.0000  1.1 0.9 0;
  14 100.0   1.00  0.0000   0.0000  1.1 0.9 0;
  15 100.0   1.00  3.2000   1.5300  1.1 0.9 0;
  16 100.0   1.00  3.2900   0.3230  1.1 0.9 0;
  17 100.0   1.00  0.0000   0.0000  1.1 0.9 0;
  18 100.0   1.00  1.5800   0.3000  1.1 0.9 0;
  19 100.0   1.00  0.0000   0.0000  1.1 0.9 0;
  20 100.0   1.00  6.8000   1.0300  1.1 0.9 0;
  21 100.0   1.00  2.7400   1.1500  1.1 0.9 0;
  22 100.0   1.00  0.0000   0.0000  1.1 0.9 0;
  23 100.0   1.00  2.4750   0.8460  1.1 0.9 0;
  24 100.0   1.00  3.0860   -0.922  1.1 0.9 0;
  25 100.0   1.00  2.2400   0.4720  1.1 0.9 0;
  26 100.0   1.00  1.3900   0.1700  1.1 0.9 0;
  27 100.0   1.00  2.8100   0.7550  1.1 0.9 0;
  28 100.0   1.00  2.0600   0.2760  1.1 0.9 0;
  29 100.0   1.00  2.8350   0.2690  1.1 0.9 0;
  31 100.0   1.00  0        0       1.1 0.9 0; % Station load set to 0
  39 100.0   1.00  11.040   2.5000  1.1 0.9 0];
  
% From Bus, To Bus, P Rating, V Rating, F Rating, Length, NA, R, X, B, NA,
% NA, I Max, P Max, S Max, conn status
Line.con = [ ...
   1    2   100.00   1.00 60 0  0.00  0.00350  0.04110  0.69870  1.00000  0.00000 0    0.000    0.000;
   1   39   100.00   1.00 60 0  0.00  0.00100  0.02500  0.75000  1.00000  0.00000 0    0.000    0.000;
   2    3   100.00   1.00 60 0  0.00  0.00130  0.01510  0.25720  1.00000  0.00000 0    0.000    0.000;
   2   25   100.00   1.00 60 0  0.00  0.00700  0.00860  0.14600  1.00000  0.00000 0    0.000    0.000;
   2   30   100.00   1.00 60 0  1     0.00000  0.01810  0.00000  1.02500  0.00000 0    0.000    0.000;
   3    4   100.00   1.00 60 0  0.00  0.00130  0.02130  0.22140  1.00000  0.00000 0    0.000    0.000;
   3   18   100.00   1.00 60 0  0.00  0.00110  0.01330  0.21380  1.00000  0.00000 0    0.000    0.000;
   4    5   100.00   1.00 60 0  0.00  0.00080  0.01280  0.13420  1.00000  0.00000 0    0.000    0.000;
   4   14   100.00   1.00 60 0  0.00  0.00080  0.01290  0.13820  1.00000  0.00000 0    0.000    0.000;
   5    8   100.00   1.00 60 0  0.00  0.00080  0.01120  0.14760  1.00000  0.00000 0    0.000    0.000;
   6    5   100.00   1.00 60 0  0.00  0.00020  0.00260  0.04340  1.00000  0.00000 0    0.000    0.000;
   6    7   100.00   1.00 60 0  0.00  0.00060  0.00920  0.11300  1.00000  0.00000 0    0.000    0.000;
   6   11   100.00   1.00 60 0  0.00  0.00070  0.00820  0.13890  1.00000  0.00000 0    0.000    0.000;
   7    8   100.00   1.00 60 0  0.00  0.00040  0.00460  0.07800  1.00000  0.00000 0    0.000    0.000;
   8    9   100.00   1.00 60 0  0.00  0.00230  0.03630  0.38040  1.00000  0.00000 0    0.000    0.000;
   9   39   100.00   1.00 60 0  0.00  0.00100  0.02500  1.20000  1.00000  0.00000 0    0.000    0.000;
  10   11   100.00   1.00 60 0  0.00  0.00040  0.00430  0.07290  1.00000  0.00000 0    0.000    0.000;
  10   13   100.00   1.00 60 0  0.00  0.00040  0.00430  0.07290  1.00000  0.00000 0    0.000    0.000;
  10   32   100.00   1.00 60 0  1     0.00000  0.02000  0.00000  1.07000  0.00000 0    0.000    0.000;
  12   11   100.00   1.00 60 0  1     0.00160  0.04350  0.00000  1.00600  0.00000 0    0.000    0.000;
  12   13   100.00   1.00 60 0  1     0.00160  0.04350  0.00000  1.00600  0.00000 0    0.000    0.000;
  13   14   100.00   1.00 60 0  0.00  0.00090  0.01010  0.17230  1.00000  0.00000 0    0.000    0.000;
  14   15   100.00   1.00 60 0  0.00  0.00180  0.02170  0.36600  1.00000  0.00000 0    0.000    0.000;
  15   16   100.00   1.00 60 0  0.00  0.00090  0.00940  0.17100  1.00000  0.00000 0    0.000    0.000;
  16   17   100.00   1.00 60 0  0.00  0.00070  0.00890  0.13420  1.00000  0.00000 0    0.000    0.000;
  16   19   100.00   1.00 60 0  0.00  0.00160  0.01950  0.30400  1.00000  0.00000 0    0.000    0.000;
  16   21   100.00   1.00 60 0  0.00  0.00080  0.01350  0.25480  1.00000  0.00000 0    0.000    0.000;
  16   24   100.00   1.00 60 0  0.00  0.00030  0.00590  0.06800  1.00000  0.00000 0    0.000    0.000;
  17   18   100.00   1.00 60 0  0.00  0.00070  0.00820  0.13190  1.00000  0.00000 0    0.000    0.000;
  17   27   100.00   1.00 60 0  0.00  0.00130  0.01730  0.32160  1.00000  0.00000 0    0.000    0.000;
  19   33   100.00   1.00 60 0  1     0.00070  0.01420  0.00000  1.07000  0.00000 0    0.000    0.000;
  19   20   100.00   1.00 60 0  1     0.00070  0.01380  0.00000  1.06000  0.00000 0    0.000    0.000;
  20   34   100.00   1.00 60 0  1     0.00090  0.01800  0.00000  1.00900  0.00000 0    0.000    0.000;
  21   22   100.00   1.00 60 0  0.00  0.00080  0.01400  0.25650  1.00000  0.00000 0    0.000    0.000;
  22   23   100.00   1.00 60 0  0.00  0.00060  0.00960  0.18460  1.00000  0.00000 0    0.000    0.000;
  22   35   100.00   1.00 60 0  1     0.00000  0.01430  0.00000  1.02500  0.00000 0    0.000    0.000;
  23   24   100.00   1.00 60 0  0.00  0.00220  0.03500  0.36100  1.00000  0.00000 0    0.000    0.000;
  23   36   100.00   1.00 60 0  1.00  0.00050  0.02720  0.00000  1.00000  0.00000 0    0.000    0.000;
  25   26   100.00   1.00 60 0  0.00  0.00320  0.03230  0.53100  1.00000  0.00000 0    0.000    0.000;
  25   37   100.00   1.00 60 0  1     0.00060  0.02320  0.00000  1.02500  0.00000 0    0.000    0.000;
  26   27   100.00   1.00 60 0  0.00  0.00140  0.01470  0.23960  1.00000  0.00000 0    0.000    0.000;
  26   28   100.00   1.00 60 0  0.00  0.00430  0.04740  0.78020  1.00000  0.00000 0    0.000    0.000;
  26   29   100.00   1.00 60 0  0.00  0.00570  0.06250  1.02900  1.00000  0.00000 0    0.000    0.000;
  28   29   100.00   1.00 60 0  0.00  0.00140  0.01510  0.24900  1.00000  0.00000 0    0.000    0.000;
  29   38   100.00   1.00 60 0  1     0.00080  0.01560  0.00000  1.02500  0.00000 0    0.000    0.000;
   6   31   100.00   1.00 60 0  1     0.00000  0.02500  0.00000  1.07000  0.00000 0    0.000    0.000];

% Additional Info
Line.con(:,10) = 0; % No susceptance
Line.con(:,11) = 1; % Tap Ratio = 1 (to simplify analysis)
Line.con(:,16) = 1; % All lines connected

% Scale Resistance
Line.con(:,8) = RSc*Line.con(:,8);
  
% Bus Num, P Rating, V Rating, F Rating, Model, Xl, Ra...
Syn.con = [ ... 
   30  100.0  1.0  60  2  0.0125  0.00014  0.1000  0.0310  0  10.20  0  0.0690  0.0310  0  1.500  0 84.000  25  0.00  0  1  1  0.002;
   31  100.0  1.0  60  2  0.035   0.00270  0.2950  0.0697  0  6.560  0  0.2820  0.170   0  1.500  0 60.600  25  0.00  0  1  1  0.002;
   32  100.0  1.0  60  2  0.0304  0.000386 0.2495  0.0531  0  5.700  0  0.2370  0.0531  0  1.500  0 70.600  25  0.00  0  1  1  0.002;
   33  100.0  1.0  60  2  0.0295  0.000222 0.2620  0.0436  0  5.690  0  0.2580  0.0436  0  1.500  0 57.200  25  0.00  0  1  1  0.002;
   34  100.0  1.0  60  2  0.0540  0.00014  0.6700  0.1320  0  5.400  0  0.6200  0.1320  0  0.440  0 52.000  25  0.00  0  1  1  0.002;
   35  100.0  1.0  60  2  0.0224  0.00615  0.2540  0.0500  0  7.300  0  0.2410  0.0500  0  0.400  0 69.600  25  0.00  0  1  1  0.002;
   36  100.0  1.0  60  2  0.0322  0.000268 0.2950  0.0490  0  5.660  0  0.2920  0.0490  0  1.500  0 52.800  25  0.00  0  1  1  0.002;
   37  100.0  1.0  60  2  0.0280  0.000686 0.2900  0.0570  0  6.700  0  0.2800  0.0570  0  0.410  0 48.600  25  0.00  0  1  1  0.002;
   38  100.0  1.0  60  2  0.0298  0.00030  0.2106  0.0570  0  4.790  0  0.2050  0.0570  0  1.960  0 69.000  25  0.00  0  1  1  0.002;
   39  100.0  1.0  60  2  0.0030  0.00010  0.0200  0.0060  0  7.000  0  0.019  0.008    0  0.700  0 1000.0  25  0.00  0  1  1  0.002];;

% Damping Parameters         
DM_fac        =  [0.65;0.55;0.7;0.4;0.6;0.45;0.3;0.8;0.35;0.5];
Syn.con(:,19) = DM_fac.*Syn.con(:,18);

% Model Parameters
Syn.con(:,[6 7 8 9 10 13 14 15]) = (16.5/69)^2*Syn.con(:,[6 7 8 9 10 13 14 15]);

% Scale Damping
Syn.con(:,19) = DSc*Syn.con(:,19);

% Bus Names
Varname.bus = { ...
  'BUS-01 '; 'BUS-02 '; 'BUS-03 '; 'BUS-04 '; 'BUS-05 ';
  'BUS-06 '; 'BUS-07 '; 'BUS-08 '; 'BUS-09 '; 'BUS-10';
  'BUS-11'; 'BUS-12'; 'BUS-13'; 'BUS-14'; 'BUS-15';
  'BUS-16'; 'BUS-17'; 'BUS-18'; 'BUS-19'; 'BUS-20';
  'BUS-21'; 'BUS-22'; 'BUS-23'; 'BUS-24'; 'BUS-25';
  'BUS-26'; 'BUS-27'; 'BUS-28'; 'BUS-29'; 'BUS-30';
  'BUS-31'; 'BUS-32'; 'BUS-33'; 'BUS-34'; 'BUS-35';
  'BUS-36'; 'BUS-37'; 'BUS-38'; 'BUS-39'};